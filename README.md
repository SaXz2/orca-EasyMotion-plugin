# Orca EasyMotion Plugin

这是一个为 Orca 笔记应用开发的 EasyMotion 快速导航插件，提供类似 Vim 的快速跳转功能。

## 功能特性

- **双击 Alt 激活**: 快速按下两次 Alt 键激活 EasyMotion
- **智能搜索**: 支持中文、拼音、英文混合搜索
- **拼音匹配**: 支持完整拼音、拼音首字母、部分拼音匹配
- **关键词搜索**: 支持多个关键词搜索，用空格分隔
- **视觉标记**: 用字母键盘标记所有匹配位置
- **智能跳转**: 支持普通文本和插入按钮的跳转
- **防重复处理**: 自动处理重叠的标记位置
- **流畅动画**: 跳转时提供视觉反馈动画
- **匹配提示**: 显示拼音匹配类型（直接匹配、拼音匹配、首字母匹配等）

## 使用方法

1. **激活搜索**: 双击 Alt 键
2. **输入搜索词**: 在弹出的搜索框中输入要搜索的关键词
   - 支持中文：直接输入中文词汇
   - 支持拼音：输入完整拼音（如 "beijing"）或拼音首字母（如 "bj"）
   - 支持混合：中文、拼音、英文混合搜索
   - 支持多个关键词：用空格分隔
3. **快速跳转**:
   - 如果只有一个匹配项，会自动跳转
   - 多个匹配项时，会显示字母标记，按下对应字母键跳转
   - 跳转时会显示匹配类型提示（拼音匹配、直接匹配等）
   - 可以按 Backspace 删除输入，按 Esc 退出

### 拼音搜索示例

- 搜索 "北京" 可以找到包含 "北京" 的文本
- 搜索 "beijing" 也可以找到包含 "北京" 的文本
- 搜索 "bj" 可以找到包含 "北京" 的文本（拼音首字母）
- 搜索 "bei" 可以找到包含 "北" 的文本（部分拼音）

## 快捷键

- `双击 Alt`: 激活/关闭 EasyMotion 搜索
- `字母键 (q/w/e/r/a/s/d/f/z/x/c/v)`: 跳转到对应标记
- `Backspace`: 删除最后一个输入字符
- `Esc`: 退出 EasyMotion 模式
- `Enter`: 在搜索框中确认搜索
- `Alt` + `字母组合`: 支持多级标记（如 qa, ws, ex 等）

## 技术实现

该插件基于以下技术栈：

- **TypeScript**: 类型安全的开发
- **Vite**: 快速构建工具
- **Orca Plugin API**: 集成 Orca 笔记应用

### 核心组件

1. **EasyMotionManager**: 主要的功能管理类
   - 键盘事件处理
   - 搜索和匹配算法
   - 视觉标记渲染
   - 跳转逻辑实现

2. **搜索算法**:
   - 基于 TreeWalker 的 DOM 文本遍历
   - 正则表达式匹配
   - 视口可见性检测

3. **智能标记**:
   - 防重复算法
   - 重叠位置处理
   - 动态标签生成

4. **拼音搜索引擎**:
   - 集成 pinyin-pro 库提供准确拼音转换
   - 支持完整拼音、拼音首字母、部分拼音匹配
   - 中英文混合搜索支持
   - 匹配类型识别和提示

## 开发和构建

### 安装依赖
```bash
npm install
```

这会安装包括 `pinyin-pro` 在内的所有依赖项，用于支持拼音搜索功能。

### 开发模式
```bash
npm run dev
```

### 构建
```bash
npm run build
```

构建后的文件将输出到 `dist/index.js`，可以直接在 Orca 中加载使用。

## 兼容性

- 支持现代浏览器
- 兼容 Orca 笔记应用的 DOM 结构
- 特别优化对插入按钮（`.orca-insert-*`）的支持
- 支持 Orca 内联元素（`.orca-inline-r-content`, `.orca-inline-l-text`）

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！